print("Olá mundo!")
2+2
2 -> b
0:100
2 -> b
c <- d <- e <- 3
x <- c(1, 2, 5, 9)
x
0:10
10:0
seq(10)  # Crescente de 1 a 10
seq(30, 0, by = -3)  # Decrescendo de 3 em 3
(y <- c(5, 1, 0, 10))
x + y
z <- x + y
x * 2
j <- x * 2
2^6
log(100)
log10(100)
rm(list = ls())
cat("\014")
(numero_1 <- 15)
typeof(numero_1)
(numero_2 <- 1.5)
typeof(numero_2)
(uma_letra <- "c")
typeof(uma_letra)
(texto <- "uma mensagem de texto")
typeof(texto)
(boleano <- TRUE)
typeof(boleano)
(vetor_1 <- c(1, 2, 3, 4, 5))
is.vector(vetor_1)
(vetor_2 <- c("a", "b", "c"))
is.vector(vetor_2)
vetor_3 <- c(TRUE, TRUE, FALSE, FALSE, TRUE)
vetor_3
is.vector(vetor_3)
setwd("/Users/chanahyo/Repository/Academic-Codex/MAE5911-Estatistica-e-Machine-Learning/Exercício03/code_02")
source("Config.R")
library(torch)
source("Data.R")
source("Model.R")   # aqui já estão HeteroNormalNet, QuantileNormalNet, etc.
source("Train.R")
# ------------------------------------------------------------------
# escolhe o nível de quantil (pego do Config, mas pode ser fixo)
q_level <- config$q  # por ex., 0.75
# cria o modelo de quantil + variância heteroscedástica
model <- QuantileNormalNet(
input_dim    = 1,
hidden_q     = 10,
hidden_sigma = 10
)
# treina
res <- treinar_normal_quantil(
model      = model,
q_level    = q_level,
epochs     = 10000,
lr         = 2e-3
)
setwd("/Users/chanahyo/Repository/Academic-Codex/MAE5911-Estatistica-e-Machine-Learning/Exercício03/code_02")
source("Config.R")
library(torch)
source("Data.R")
source("Model.R")   # aqui já estão HeteroNormalNet, QuantileNormalNet, etc.
source("Train.R")
# ------------------------------------------------------------------
# escolhe o nível de quantil (pego do Config, mas pode ser fixo)
q_level <- config$q  # por ex., 0.75
# cria o modelo de quantil + variância heteroscedástica
model <- QuantileNormalNet(
input_dim    = 1,
hidden_q     = 10,
hidden_sigma = 10
)
# treina
res <- treinar_normal_quantil(
model      = model,
q_level    = q_level,
epochs     = 10000,
lr         = 2e-3
)
source("Config.R")
library(torch)
source("Data.R")
source("Model.R")   # aqui já estão HeteroNormalNet, QuantileNormalNet, etc.
source("Train.R")
# ------------------------------------------------------------------
# escolhe o nível de quantil (pego do Config, mas pode ser fixo)
q_level <- config$q  # por ex., 0.75
# cria o modelo de quantil + variância heteroscedástica
model <- QuantileNormalNet(
input_dim    = 1,
hidden_q     = 10,
hidden_sigma = 10
)
# treina
res <- treinar_normal_quantil(
model      = model,
q_level    = q_level,
epochs     = 10000,
lr         = 2e-3
)
source("Config.R")
library(torch)
source("Data.R")
source("Model.R")   # aqui já estão HeteroNormalNet, QuantileNormalNet, etc.
source("Train.R")
# ------------------------------------------------------------------
# escolhe o nível de quantil (pego do Config, mas pode ser fixo)
q_level <- config$q  # por ex., 0.75
# cria o modelo de quantil + variância heteroscedástica
model <- QuantileNormalNet(
input_dim    = 1,
hidden_q     = 10,
hidden_sigma = 10
)
# treina
res <- treinar_normal_quantil(
model      = model,
q_level    = q_level,
epochs     = 10000,
lr         = 2e-3
)
source("Config.R")
library(torch)
source("Data.R")
source("Model.R")   # aqui já estão HeteroNormalNet, QuantileNormalNet, etc.
source("Train.R")
# ------------------------------------------------------------------
# escolhe o nível de quantil (pego do Config, mas pode ser fixo)
q_level <- config$q  # por ex., 0.75
# cria o modelo de quantil + variância heteroscedástica
model <- QuantileNormalNet(
input_dim    = 1,
hidden_q     = 10,
hidden_sigma = 10
)
# treina
res <- treinar_normal_quantil(
model      = model,
q_level    = q_level,
epochs     = 10000,
lr         = 2e-3
)
source("Config.R")
library(torch)
source("Data.R")
source("Model.R")   # aqui já estão HeteroNormalNet, QuantileNormalNet, etc.
source("Train.R")
# ------------------------------------------------------------------
# escolhe o nível de quantil (pego do Config, mas pode ser fixo)
q_level <- config$q  # por ex., 0.75
# cria o modelo de quantil + variância heteroscedástica
model <- QuantileNormalNet(
input_dim    = 1,
hidden_q     = 10,
hidden_sigma = 10
)
# treina
res <- treinar_normal_quantil(
model      = model,
q_level    = q_level,
epochs     = 10000,
lr         = 2e-3
)
# 5) (Opcional) salvar o modelo treinado ---------------------------
torch_save(model, "modelo_quantil_075.pt")
# 6) Exemplo de uso do modelo treinado -----------------------------
model$eval()
# novos pontos onde você quer o quantil
x_new <- seq(config$x_min, config$x_max, length.out =1000)
# quantil estimado (vetor R)
q_hat_vec <- predict_quantile_vec(model, x_new)
# se quiser visualizar rápido:
plot(x, y, pch = 16, col = rgb(0,0,0,0.1),
xlab = "x", ylab = "y", main = "Quantil 75% - modelo treinado")
lines(x, f_x, col = "black", lwd = 2)
lines(x_new, q_hat_vec, col = "blue", lwd = 2)
sigma2_hat_vec <- predict_sigma2_vec(model, x_new)
sigma2_hat_vec <- predict_sigma2_vec(model, x_new)
plot(x, sigma2_true, type = "l", lwd = 2,
xlab = "x", ylab = expression(sigma^2),
main = expression(sigma(x)^2 ~ ": verdadeiro vs aprendido"))
lines(x_new, sigma2_hat_vec, col = "blue", lwd = 2)
legend("topleft",
legend = c(expression(sigma(x)^2),
expression(hat(sigma)(x)^2)),
col = c("black", "blue"),
lwd = 2, bty = "n")
model$eval()
# novos pontos onde você quer o quantil
x_new <- seq(config$x_min, config$x_max, length.out =1000)
# quantil estimado (vetor R)
q_hat_vec <- predict_quantile_vec(model, x_new)
# se quiser visualizar rápido:
plot(x, y, pch = 16, col = rgb(0,0,0,0.1),
xlab = "x", ylab = "y", main = "Quantil 75% - modelo treinado")
lines(x, f_x, col = "black", lwd = 2)
lines(x_new, q_hat_vec, col = "blue", lwd = 2)
sigma2_hat_vec <- predict_sigma2_vec(model, x_new)
plot(x, sigma2_true, type = "l", lwd = 2,
xlab = "x", ylab = expression(sigma^2),
main = expression(sigma(x)^2 ~ ": verdadeiro vs aprendido"))
lines(x_new, sigma2_hat_vec, col = "blue", lwd = 2)
legend("topleft",
legend = c(expression(sigma(x)^2),
expression(hat(sigma)(x)^2)),
col = c("black", "blue"),
lwd = 2, bty = "n")
model$eval()
# novos pontos
x_new <- seq(config$x_min, config$x_max, length.out = 1000)
# previsões
q_hat_vec     <- predict_quantile_vec(model, x_new)
sigma2_hat_vec <- predict_sigma2_vec(model, x_new)
# plot dos dados
plot(x, y, pch = 16, col = rgb(0,0,0,0.1),
xlab = "x", ylab = "y", main = "Quantil 75% e variância aprendida")
# média verdadeira (opcional)
lines(x, f_x, col = "black", lwd = 2)
# quantil aprendido
lines(x_new, q_hat_vec, col = "blue", lwd = 2)
# variância aprendida (em outro eixo visual)
par(new = TRUE)
plot(x_new, sigma2_hat_vec, type="l", col="red", lwd = 2,
axes = FALSE, xlab = "", ylab = "")
axis(side = 4)
mtext("σ²(x)", side = 4, line = 2, col = "red")
model$eval()
# novos pontos onde você quer o quantil
x_new <- seq(config$x_min, config$x_max, length.out =1000)
# quantil estimado (vetor R)
q_hat_vec <- predict_quantile_vec(model, x_new)
# se quiser visualizar rápido:
plot(x, y, pch = 16, col = rgb(0,0,0,0.1),
xlab = "x", ylab = "y", main = "Quantil 75% - modelo treinado")
lines(x, f_x, col = "black", lwd = 2)
lines(x_new, q_hat_vec, col = "blue", lwd = 2)
sigma2_hat_vec <- predict_sigma2_vec(model, x_new)
plot(x, sigma2_true, type = "l", lwd = 2,
xlab = "x", ylab = expression(sigma^2),
main = expression(sigma(x)^2 ~ ": verdadeiro vs aprendido"))
lines(x_new, sigma2_hat_vec, col = "blue", lwd = 2)
legend("topleft",
legend = c(expression(sigma(x)^2),
expression(hat(sigma)(x)^2)),
col = c("black", "blue"),
lwd = 2, bty = "n")
plot(x, y, pch = 16, col = rgb(0,0,0,0.1),
xlab = "x", ylab = "y", main = "Quantil 75% - modelo treinado")
lines(x, f_x, col = "black", lwd = 2)
lines(x_new, q_hat_vec, col = "blue", lwd = 2)
source("Config.R")
library(torch)
source("Data.R")
source("Model.R")   # aqui já estão HeteroNormalNet, QuantileNormalNet, etc.
source("Train.R")
model$eval()
# novos pontos onde você quer o quantil
x_new <- seq(config$x_min, config$x_max, length.out =1000)
# quantil estimado (vetor R)
q_hat_vec <- predict_quantile_vec(model, x_new)
# se quiser visualizar rápido:
plot(x, y, pch = 16, col = rgb(0,0,0,0.1),
xlab = "x", ylab = "y", main = "Quantil 75% - modelo treinado")
lines(x, f_x, col = "black", lwd = 2)
lines(x_new, q_hat_vec, col = "blue", lwd = 2)
sigma2_hat_vec <- predict_sigma2_vec(model, x_new)
plot(x, sigma2_true, type = "l", lwd = 2,
xlab = "x", ylab = expression(sigma^2),
main = expression(sigma(x)^2 ~ ": verdadeiro vs aprendido"))
lines(x_new, sigma2_hat_vec, col = "blue", lwd = 2)
legend("topleft",
legend = c(expression(sigma(x)^2),
expression(hat(sigma)(x)^2)),
col = c("black", "blue"),
lwd = 2, bty = "n")
source("Config.R")
library(torch)
source("Data.R")
source("Model.R")   # aqui já estão HeteroNormalNet, QuantileNormalNet, etc.
source("Train.R")
# ---
source("Config.R")
library(torch)
source("Data.R")
source("Model.R")   # aqui já estão HeteroNormalNet, QuantileNormalNet, etc.
source("Train.R")
# ------------------------------------------------------------------
# escolhe o nível de quantil (pego do Config, mas pode ser fixo)
q_level <- config$q  # por ex., 0.75
# cria o modelo de quantil + variância heteroscedástica
model <- QuantileNormalNet(
input_dim    = 1,
hidden_q     = 10,
hidden_sigma = 10
)
# treina
res <- treinar_normal_quantil(
model      = model,
q_level    = q_level,
epochs     = 10000,
lr         = 2e-3
)
source("Config.R")
library(torch)
source("Data.R")
source("Model.R")   # aqui já estão HeteroNormalNet, QuantileNormalNet, etc.
source("Train.R")
model$eval()
# novos pontos onde você quer o quantil
x_new <- seq(config$x_min, config$x_max, length.out =1000)
# quantil estimado (vetor R)
q_hat_vec <- predict_quantile_vec(model, x_new)
# se quiser visualizar rápido:
plot(x, y, pch = 16, col = rgb(0,0,0,0.1),
xlab = "x", ylab = "y", main = "Quantil 75% - modelo treinado")
lines(x, f_x, col = "black", lwd = 2)
lines(x_new, q_hat_vec, col = "blue", lwd = 2)
sigma2_hat_vec <- predict_sigma2_vec(model, x_new)
plot(x, sigma2_true, type = "l", lwd = 2,
xlab = "x", ylab = expression(sigma^2),
main = expression(sigma(x)^2 ~ ": verdadeiro vs aprendido"))
lines(x_new, sigma2_hat_vec, col = "blue", lwd = 2)
legend("topleft",
legend = c(expression(sigma(x)^2),
expression(hat(sigma)(x)^2)),
col = c("black", "blue"),
lwd = 2, bty = "n")
source("Config.R")
library(torch)
source("Data.R")
source("Model.R")   # aqui já estão HeteroNormalNet, QuantileNormalNet, etc.
source("Train.R")
# ------------------------------------------------------------------
# escolhe o nível de quantil (pego do Config, mas pode ser fixo)
q_level <- config$q  # por ex., 0.75
# cria o modelo de quantil + variância heteroscedástica
model <- QuantileNormalNet(
input_dim    = 1,
hidden_q     = 10,
hidden_sigma = 10
)
# treina
res <- treinar_normal_quantil(
model      = model,
q_level    = q_level,
epochs     = 10000,
lr         = 2e-3
)
