\documentclass[a4paper]{article}
\usepackage{student}
\usepackage{graphicx}
\usepackage{caption}
\usepackage[version=4]{mhchem}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, arrows.meta, positioning, decorations.pathreplacing}
\usepackage{enumitem}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{booktabs}
\usepackage{float}
\usepackage[portuguese]{babel}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[numbers,sort&compress]{natbib} % ou [authoryear]
\usepackage[alf]{abntex2cite} % citação ABNT autor-data
\usepackage{enumerate}
\usepackage{tcolorbox}
\usepackage{listings}
\usepackage{xcolor}

% --- Suporte a UTF-8 ---
\usepackage{lmodern}           % fonte moderna compatível com T1

% --- Pacotes para exibir código ---


% --- Define o idioma R com palavras-chave e cores ---
\lstdefinelanguage{R}{
  keywords={function, if, else, for, in, while, repeat, return, library, require, next, break},
  keywordstyle=\color{blue}\bfseries,
  ndkeywords={TRUE, FALSE, NULL, NA, Inf, NaN},
  ndkeywordstyle=\color{magenta}\bfseries,
  comment=[l]{\#},
  commentstyle=\color{gray}\ttfamily,
  stringstyle=\color{orange}\ttfamily,
  morestring=[b]",
  morestring=[b]',
  sensitive=true
}

% --- Mapeamento para UTF-8 (acentos, ç, etc.) ---
% ---- estilo do listing ----
\lstset{
  literate=
    {á}{{\'a}}1 {ã}{{\~a}}1 {â}{{\^a}}1 {à}{{\`a}}1
    {é}{{\'e}}1 {ê}{{\^e}}1
    {í}{{\'i}}1
    {ó}{{\'o}}1 {õ}{{\~o}}1 {ô}{{\^o}}1
    {ú}{{\'u}}1 {ü}{{\"u}}1
    {ç}{{\c{c}}}1
    {Á}{{\'A}}1 {Ã}{{\~A}}1 {Â}{{\^A}}1
    {É}{{\'E}}1 {Ê}{{\^E}}1
    {Í}{{\'I}}1
    {Ó}{{\'O}}1 {Õ}{{\~O}}1 {Ô}{{\^O}}1
    {Ú}{{\'U}}1 {Ü}{{\"U}}1
    {Ç}{{\c{C}}}1,
  basicstyle=\ttfamily\small,
  backgroundcolor=\color{gray!5},
  frame=single,
  breaklines=true,
  captionpos=b,
  columns=flexible,
  showstringspaces=false,
  keepspaces=true,
  numbers=left,
  numberstyle=\tiny\color{gray},
  stepnumber=1,
  numbersep=6pt
}

\pagestyle{plain}

\tikzstyle{arrow} = [thick,->,>=stealth]

% Definindo o estilo de destaque com linhas pontilhadas
\tikzstyle{highlight} = [draw, dashed, thick, rectangle, rounded corners, inner sep=0.2cm, orange]


\tikzstyle{startstop} = [
    rectangle, rounded corners, minimum width=0.5cm,
    text centered, draw=black, fill=blue!10, font=\small
]
\tikzstyle{startstop_S} = [
    rectangle, rounded corners, minimum width=0.5cm, minimum height=0.8cm,
    text centered, draw=black, fill=green!30, font=\small
]
\tikzstyle{decision} = [
    diamond, aspect=2, draw=black, fill=orange!15, align=center,
    text centered, inner sep=0pt, font=\small
]
\tikzstyle{decision_S} = [
    diamond, aspect=2, draw=black, fill=orange!30, align=center,
    text centered, inner sep=0pt, font=\small
]
\tikzstyle{arrow} = [thick,->,>=stealth]



% Metadata
\date{\today}
\setmodule{MAE5911/IME: Fundamentos de Estatística e Machine Learning. \\ Prof.: Alexandre Galvão Patriota} 
\setterm{2o. semestre, 2025}

%-------------------------------%
% Other details
% TODO: Fill these
%-------------------------------%
\title{Exercício 02 - 15/10}
\setmembername{Nara Avila Moraes}  % Fill group member names
\setmemberuid{5716734}  % Fill group member uids (same order)

%-------------------------------%
% Add / Delete commands and packages
% TODO: Add / Delete here as you need
%-------------------------------%
\usepackage{amsmath,amssymb,bm}

\newcommand{\KL}{\mathrm{KL}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\T}{\top}

\newcommand{\expdist}[2]{%
        \normalfont{\textsc{Exp}}(#1, #2)%
    }
\newcommand{\expparam}{\bm \lambda}
\newcommand{\Expparam}{\bm \Lambda}
\newcommand{\natparam}{\bm \eta}
\newcommand{\Natparam}{\bm H}
\newcommand{\sufstat}{\bm u}

% Main document
\begin{document}
% Add header
\header{}

\textbf{Questão 01:}
Seja $(Z_1, \ldots, Z_n)$ uma amostra aleatória de $Z \sim \text{Ber}(\theta)$, $\theta \in (0,1)$.
\begin{itemize}
    \item[(a)] Encontre o EMV para $g(\theta) = P_\theta(Z = 0)$.
    \item[(b)] Encontre o EMV para $g(\theta) = \mathrm{Var}_\theta(Z)$.
    \item[(c)] Considere que os dados foram observados (0, 0, 1, 0, 0, 1). Encontre as estimativas de MV nos itens acima.
    \item[(d)] Construa o valor-p para a hipótese H: ``$\theta = 0.1$'' usando os dados do item anterior.
\end{itemize}

\begin{research}[]
    \input{research01}
\end{research}

\begin{answer}[]
    \input{resposta01}
\end{answer}


\textbf{Questão 02:}
Seja $(Z_1, \ldots, Z_n)$ uma amostra aleatória de $Z \sim \text{Exp}(\theta)$, $\theta \in (0,\infty)$.
\begin{itemize}
    \item[(a)] Encontre o EMV para $g(\theta) = P_\theta(Z > 1)$.
    \item[(b)] Encontre o EMV para $g(\theta) = P_\theta(0.1 < Z < 1)$.
    \item[(c)] Encontre o EMV para $g(\theta) = \mathrm{Var}_\theta(Z)$.
    \item[(d)] Considere que os dados foram observados (0.2, 0.6, 0.3, 0.2, 0.8, 0.12). Encontre um IC aproximado de 95\% de confiança para $g(\theta)$ nos itens acima.
    \item[(e)] Faça uma simulação de Monte Carlo para verificar se os IC's aproximados obtidos no passo anterior têm cobertura próxima do nível de confiança estabelecido. Caso não tenham, proponha um tamanho amostral que produza IC's mais confiáveis para cada caso.
\end{itemize}

\begin{research}[]
    \input{research02}
\end{research}

\begin{answer}[]
    \input{resposta02}
\end{answer}
\begin{lstlisting}[language=R, caption={Simulação de Monte Carlo para testar o intervalo de confiança encontrado para a letra (a)}]
set.seed(123)

# Parâmetros do experimento
theta0   <- 2.703     # "verdadeiro" theta
n        <- 6         # tamanho da amostra
M        <- 1000      # número de simulações
z_0975   <- 1.96      # quantil 0.975 da N(0,1)

# valor verdadeiro de g(theta) = P(Z > 1)
g_true <- exp(-theta0)

# vetor para guardar se o IC cobriu ou não
covered <- logical(M)

for (m in 1:M) {
  # 1) cria uma amostra com distribuição Exponencial(theta0)
  z <- rexp(n, theta0)
  
  # 2) EMV de theta: 1 / media
  theta_hat <- 1 / mean(z)
  
  # 3) IC aproximado para theta
  L_theta <- theta_hat * (1 - z_0975 / sqrt(n))
  U_theta <- theta_hat * (1 + z_0975 / sqrt(n))
  
  # 4) transforma para g(theta) = e^{-theta}
  L_g <- exp(-U_theta)
  U_g <- exp(-L_theta)
  
  # 5) verifica se g_true está no intervalo
  covered[m] <- (L_g <= g_true) && (g_true <= U_g)
}

# Estimativa da cobertura
mean(covered)
\end{lstlisting}

\begin{lstlisting}[language=R, caption={Simulação de Monte Carlo para testar o intervalo de confiança encontrado para a letra (b)}]
set.seed(123)

# Parâmetros do experimento
theta0  <- 2.703        # "verdadeiro" theta (mesmo do item a)
n       <- 6            # tamanho da amostra
M       <- 10000        # número de simulações
z_0975  <- 1.96         # quantil 0.975 da N(0,1)

# Função g(theta) do item (b):
# g(theta) = P(0.1 < Z < 1) = exp(-0.1*theta) - exp(-theta)
g_fun  <- function(theta) exp(-0.1 * theta) - exp(-theta)
g_true <- g_fun(theta0)

# Ponto onde g(theta) atinge seu máximo
theta_star <- log(10) / 0.9

covered <- logical(M)

for (m in 1:M) {
  
  # 1) Amostra Z_1,...,Z_n ~ Exponencial(theta0)
  z <- rexp(n, rate = theta0)
  
  # 2) EMV de theta: 1 / media
  theta_hat <- 1 / mean(z)
  
  # 3) IC aproximado para theta
  L_theta <- theta_hat * (1 - z_0975 / sqrt(n))
  U_theta <- theta_hat * (1 + z_0975 / sqrt(n))
  
  # 4) Intervalo para g(theta)
  g_L <- g_fun(L_theta)
  g_U <- g_fun(U_theta)
  
  # Como g(theta) NÂO é monotona, verificamos se o máximo está no intervalo
  if (L_theta <= theta_star && theta_star <= U_theta) {
    g_max <- g_fun(theta_star)
    g_min <- min(g_L, g_U)
  } else {
    g_min <- min(g_L, g_U)
    g_max <- max(g_L, g_U)
  }
  
  # 5) Verifica cobertura
  covered[m] <- (g_min <= g_true) && (g_true <= g_max)
}

# Estimativa da cobertura
mean(covered)
\end{lstlisting}

\textbf{Questão 03:}
Seja $(Z_1, \ldots, Z_n)$ uma amostra aleatória de $Z \sim N(\mu, \sigma^2)$, $\theta = (\mu, \sigma^2) \in (-\infty,\infty) \times (0,\infty)$.
\begin{itemize}
    \item[(a)] Encontre o EMV para $g(\theta) = E_\theta(Z)$.
    \item[(b)] Encontre o EMV para $g(\theta) = P_\theta(Z < 2)$.
    \item[(c)] Encontre o EMV para $g(\theta) = P_\theta(2.6 < Z < 4)$.
    \item[(d)] Encontre o EMV para $g(\theta) = \mathrm{Var}_\theta(Z)$.
    \item[(e)] Considere que os dados foram observados (2.4, 2.7, 2.3, 2, 2.5, 2.6). Encontre as estimativas de MV nos itens acima.
\end{itemize}


\begin{research}[]
    \input{research03}
\end{research}

\begin{answer}[]
    \input{resposta03}
\end{answer}

\textbf{Questão 04:}
Seja $(Z_1, \ldots, Z_n)$ uma amostra aleatória de $Z \sim f_\theta$, $\theta \in (0,\infty)$, tal que a função densidade de probabilidade é dada por
\[
    f_\theta(x) = \theta \, x^{\theta-1}, \quad x \in (0,1),
\]
e $f_\theta(x) = 0$, caso contrário.
\begin{itemize}
    \item[(a)] Encontre o EMV para $g(\theta) = E_\theta(Z)$.
    \item[(b)] Encontre o EMV para $g(\theta) = P_\theta(Z > 0.3)$.
    \item[(c)] Encontre o EMV para $g(\theta) = P_\theta(0 < Z < 0.1)$.
    \item[(d)] Encontre o EMV para $g(\theta) = \mathrm{Var}_\theta(Z)$.
    \item[(e)] Considere que os dados foram observados (0.12, 0.50, 0.20, 0.23, 0.30, 0.11). Encontre as estimativas de MV para os itens acima.
\end{itemize}

\begin{research}[]
    \input{research04}
\end{research}
\begin{answer}[]
    \input{resposta04}
\end{answer}

\nocite{patriota2025notas}
\nocite{fonseca2008curso}
\bibliographystyle{plain}
\bibliography{refs}
\end{document}
\end{document}
